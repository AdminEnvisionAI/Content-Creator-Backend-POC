from beanie import Document
from bson import ObjectId
from pydantic import BaseModel, Field
from datetime import datetime
from typing import List, Optional, Dict, Any

class VideoStats(BaseModel):
    video_id: str
    title: str
    publishedAt: str
    viewCount: int
    likeCount: int
    commentCount: int

class InfluencerModel(Document):
    channel_id: str
    channel_name: str
    subscribers: int
    total_views: int
    upload_count: int
    topics: Optional[List[str]] = None
    videos: List[VideoStats]
    createdAt: datetime = Field(default_factory=datetime.utcnow)

    class Settings:
        name = "influencers"

    class Config:
        json_encoders = {
            ObjectId: str,
            datetime: lambda v: v.isoformat()
        }
